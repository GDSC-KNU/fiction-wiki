(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[518],{9441:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fictions/[id]/edit",function(){return r(165)}])},165:function(e,t,r){"use strict";r.r(t);var i=r(1224),n=r(1904),s=r(7559),o=r(8473),l=r(2760),a=r(5008),d=r(8598),c=r(6625),u=r(9991),m=r(2217),p=r(5049),f=r(548),x=r(4376),h=r(2684),v=r(5367),y=r(71),b=r.n(y),g=r(6040),w=r(1774),j=r.n(w),Z=(r(1387),r(4412),j()((function(){return Promise.all([r.e(271),r.e(238)]).then(r.bind(r,7043))}),{loadableGenerated:{webpack:function(){return[7043]}},ssr:!1}));t.default=function(){var e=function(e){var t=new Date(e),r=""+(t.getMonth()+1),i=""+t.getDate(),n=t.getFullYear();return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),[n,r,i].join("-")},t=(0,h.useState)(""),r=t[0],y=t[1],w=(0,h.useCallback)((function(e){y(e)}),[]),j=(0,x.useRouter)(),N=(0,g.ZP)(j.query.id?"/api/fictions/".concat(j.query.id):null).data,k=(0,o.Z)((0,f.Z)("/api/fictions/".concat(j.query.id)),2),B=k[0],q=k[1],F=q.loading,K=q.data,D=(q.error,(0,v.cI)({mode:"onBlur"})),T=D.register,_=D.handleSubmit,S=(D.reset,D.resetField),C=D.watch,M=(D.formState.errors,D.setValue);console.log(r),(0,h.useEffect)((function(){var t,i,n,s;N&&(M("title",N.prevFiction.title),M("relatedTitle",N.prevFiction.relatedTitle||""),M("author",(null===(t=N.prevFiction.author)||void 0===t?void 0:t.name)||""),M("relatedAuthor",N.prevFiction.relatedAuthor||""),M("nationality",N.prevFiction.nationality),M("type",N.prevFiction.type||""),M("genre",null===N||void 0===N||null===(i=N.prevFiction)||void 0===i?void 0:i.categories.reduce((function(e,t){var r,i;return(null!==(n=null===e||void 0===e||null===(r=e.category)||void 0===r?void 0:r.name)&&void 0!==n?n:"")+" "+(null!==(s=null===t||void 0===t||null===(i=t.category)||void 0===i?void 0:i.name)&&void 0!==s?s:"")}),"").trim()),M("original",N.prevFiction.original),M("platforms",[N.prevFiction.platforms]),M("currentState",N.prevFiction.currentState),M("synopsis",N.prevFiction.synopsis),M("characters",N.prevFiction.characters),M("date.0",e(N.prevFiction.startDate)),M("date.1",e(N.prevFiction.endDate)),M("currentState",N.prevFiction.currentState),M("status.0",N.prevFiction.fictionStat.originality),M("status.1",N.prevFiction.fictionStat.writing),M("status.2",N.prevFiction.fictionStat.character),M("status.3",N.prevFiction.fictionStat.verisimilitude),M("status.4",N.prevFiction.fictionStat.synopsisComposition),M("status.5",N.prevFiction.fictionStat.value),M("volume",(null===N||void 0===N?void 0:N.prevFiction.volume)||0),M("mediaMix",N.prevFiction.mediaMix||""),M("isTranslated",N.prevFiction.isTranslated||""),""===r&&y(N.prevFiction.setup||""),N.prevFiction.keywords.filter((function(e){return!1===e.keyword.isOfHeroine&&!1===e.keyword.isOfMC&&!1===e.keyword.isOfCons})).map((function(e,t){return M("keywords.".concat(t),e.keyword.name)})),N.prevFiction.keywords.filter((function(e){return!0===e.keyword.isOfMC})).map((function(e,t){return M("mcKeywords.".concat(t),e.keyword.name)})),N.prevFiction.keywords.filter((function(e){return!0===e.keyword.isOfHeroine})).map((function(e,t){return M("subKeywords.".concat(t),e.keyword.name)})),N.prevFiction.keywords.filter((function(e){return!0===e.keyword.isOfCons})).map((function(e,t){return M("consKeywords.".concat(t),e.keyword.name)})))}),[N,M]);var L=function(){var e=(0,i.Z)((function(e){var t,i,o,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return F?[2]:e.thumb&&e.thumb.length>0?[4,fetch("/api/files")]:[3,5];case 1:return[4,a.sent().json()];case 2:return t=a.sent().uploadURL,(i=new FormData).append("file",e.thumb[0],e.title),[4,fetch(t,{method:"POST",body:i})];case 3:return[4,a.sent().json()];case 4:return o=a.sent(),l=o.result.id,B((0,s.Z)((0,n.Z)({},e),{thumbId:l,setup:r}),"PUT"),[3,6];case 5:B((0,s.Z)((0,n.Z)({},e),{setup:r}),"PUT"),a.label=6;case 6:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();(0,h.useEffect)((function(){(null===K||void 0===K?void 0:K.ok)&&j.push("/fictions/".concat(K.fiction.id))}),[K,j]);var O=(0,h.useState)(""),E=O[0],H=O[1],P=C("thumb");(0,h.useEffect)((function(){if(P&&P.length>0){var e=P[0];H(URL.createObjectURL(e))}}),[P]);var A=C().keywords,R=C().mcKeywords,U=C().subKeywords,I=C().consKeywords,G=C().status;return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{children:(0,d.jsxs)("form",{className:" w-[90vw]",onSubmit:_(L,(function(e){})),children:[(0,d.jsxs)("div",{className:" max-w-[1500px]",children:[(0,d.jsxs)("div",{className:" grid grid-cols-1 sm:grid-cols-5 ",children:[(0,d.jsxs)("div",{className:" bg-white col-span-2 mx-5 mt-7 h-fit border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)("div",{className:" min-h-[330px] w-full",children:E?(0,d.jsxs)("label",{className:" relative pb-100 w-full cursor-pointer text-gray-600 hover:border-blue-500 hover:text-blue-500 flex items-center justify-center border-2 border-dashed border-gray-300 h-[330px] rounded-md",children:[(0,d.jsx)(b(),{className:" object-cover",src:E||"/",layout:"fill"}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({},T("thumb")),{className:"hidden",type:"file"}))]}):(0,d.jsxs)("label",{className:"w-full cursor-pointer text-gray-600 hover:border-blue-500 hover:text-blue-500 flex items-center justify-center border-2 border-dashed border-gray-300 h-[330px] rounded-md",children:[(0,d.jsx)("svg",{className:"h-12 w-12",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,d.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({},T("thumb")),{className:"hidden",type:"file"}))]})}),(0,d.jsxs)("div",{className:" px-4 py-3",children:[(0,d.jsx)(m.Z,{register:T("title",{required:!0}),required:!0,label:"Title",name:"title",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("relatedTitle",{required:!1}),required:!1,label:"RelatedTitle",name:"relatedTitle",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("author",{required:!0}),required:!0,label:"Author",name:"author",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("relatedAuthor",{required:!1}),required:!1,label:"RelatedAuthor",name:"relatedAuthor",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("type",{required:!1}),required:!1,label:"Type",name:"type",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("nationality",{required:!0}),required:!0,label:"Nationality",name:"nationality",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("genre"),required:!0,label:"Genre",name:"genre",type:"text_detail"}),(0,d.jsxs)("div",{className:" flex relative items-center justify-between",children:[(0,d.jsx)("div",{className:" w-[48%]",children:(0,d.jsx)(m.Z,{register:T("date.0"),required:!0,label:"StartDate",name:"startDate",type:"date"})}),(0,d.jsx)("div",{className:" w-[48%]",children:(0,d.jsx)(m.Z,{register:T("date.1"),required:!0,label:"EndDate",name:"endDate",type:"date"})})]}),(0,d.jsx)(m.Z,{register:T("original",{required:!0}),required:!0,label:"Original",name:"original",type:"text"}),(0,d.jsx)(m.Z,{register:T("platforms.0"),required:!0,label:"Platforms",name:"platforms",type:"text"}),(0,d.jsx)(m.Z,{register:T("currentState"),required:!0,label:"CurrentState",name:"currentState",type:"text"}),(0,d.jsx)(m.Z,{register:T("volume"),required:!0,label:"Volume",name:"volume",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("mediaMix"),required:!1,label:"MediaMix",name:"mediaMix",type:"text_detail"}),(0,d.jsx)(m.Z,{register:T("isTranslated",{required:!1}),required:!1,label:"IsTranslated",name:"isTranslated",type:"text_detail"})]})]}),(0,d.jsx)("div",{className:" col-span-3 mx-5 mt-7",children:(0,d.jsxs)("div",{className:" grid sm:grid-cols-1",children:[(0,d.jsxs)("div",{className:" mb-10 pb-3 px- w-full bg-white border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)("h2",{className:" font-bold pt-1 px-2",children:"Keywords"}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({className:" w-full"},T("keywords.0")),{type:"text",placeholder:" \ud0a4\uc6cc\ub4dc(,\ub97c \ub20c\ub7ec\uc11c \uc785\ub825\ud558\uc138\uc694)",onKeyDown:function(e){","===e.key&&""!==A[0].trim()&&(e.preventDefault(),A.slice(1).includes(A[0].trim())||(A[0]=A[0].trim(),A.filter((function(e){return" "!==e})),M("keywords",[A[0]].concat((0,l.Z)(A)))),S("keywords.0"))}})),(0,d.jsx)("ul",{className:" grid grid-cols-4 md:grid-cols-5 lg:grid-cols-8 xl:grid-cols-5 pt-3 px-3",children:null===A||void 0===A?void 0:A.filter((function(e){return void 0!==e})).map((function(e,t){return(0,d.jsx)("li",{className:" bg-[#3D414D] text-white text-sm text-center ring-offset-1 mx-1 my-1 rounded-md h-fit hover:cursor-pointer",onClick:function(e){A=A.filter((function(t){return t!==e.currentTarget.innerHTML})),M("keywords",A)},children:e},t)}))})]}),(0,d.jsxs)("div",{className:" mb-10 pb-3 px- w-full bg-white border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)("h2",{className:" font-bold pt-1 px-2",children:"Mc Keywords"}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({className:" w-full"},T("mcKeywords.0")),{type:"text",placeholder:" \ud0a4\uc6cc\ub4dc(,\ub97c \ub20c\ub7ec\uc11c \uc785\ub825\ud558\uc138\uc694)",onKeyDown:function(e){","===e.key&&""!==R[0].trim()&&(e.preventDefault(),R.slice(1).includes(R[0].trim())||(R[0]=R[0].trim(),R.filter((function(e){return" "!==e})),M("mcKeywords",[R[0]].concat((0,l.Z)(R)))),S("mcKeywords.0"))}})),(0,d.jsx)("ul",{className:" grid grid-cols-4 md:grid-cols-5 lg:grid-cols-8 xl:grid-cols-5 pt-3 px-3",children:null===R||void 0===R?void 0:R.filter((function(e){return void 0!==e})).map((function(e,t){return(0,d.jsx)("li",{className:" bg-[#3D414D] text-white text-sm text-center ring-offset-1 mx-1 my-1 rounded-md h-fit hover:cursor-pointer",onClick:function(e){R=R.filter((function(t){return t!==e.currentTarget.innerHTML})),M("mcKeywords",R)},children:e},t)}))})]}),(0,d.jsxs)("div",{className:" mb-10 pb-3 px- w-full bg-white border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)("h2",{className:" font-bold pt-1 px-2",children:"Sub Keywords"}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({className:" w-full"},T("subKeywords.0")),{type:"text",placeholder:" \ud0a4\uc6cc\ub4dc(,\ub97c \ub20c\ub7ec\uc11c \uc785\ub825\ud558\uc138\uc694)",onKeyDown:function(e){","===e.key&&""!==U[0].trim()&&(e.preventDefault(),U.slice(1).includes(U[0].trim())||(U[0]=U[0].trim(),U.filter((function(e){return" "!==e})),M("subKeywords",[U[0]].concat((0,l.Z)(U)))),S("subKeywords.0"))}})),(0,d.jsx)("ul",{className:" grid grid-cols-4 md:grid-cols-5 lg:grid-cols-8 xl:grid-cols-5 pt-3 px-3",children:null===U||void 0===U?void 0:U.filter((function(e){return void 0!==e})).map((function(e,t){return(0,d.jsx)("li",{className:" bg-[#3D414D] text-white text-sm text-center ring-offset-1 mx-1 my-1 rounded-md h-fit hover:cursor-pointer",onClick:function(e){U=U.filter((function(t){return t!==e.currentTarget.innerHTML})),M("subKeywords",U)},children:e},t)}))})]}),(0,d.jsxs)("div",{className:" mb-10 pb-3 px- w-full bg-white border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)("h2",{className:" font-bold pt-1 px-2",children:"Cons Keywords"}),(0,d.jsx)("input",(0,s.Z)((0,n.Z)({className:" w-full"},T("consKeywords.0")),{type:"text",placeholder:" \ud0a4\uc6cc\ub4dc(,\ub97c \ub20c\ub7ec\uc11c \uc785\ub825\ud558\uc138\uc694)",onKeyDown:function(e){var t=e.key;console.log(t),","===t&&""!==I[0].trim()&&(e.preventDefault(),I.slice(1).includes(I[0].trim())||(I[0]=I[0].trim(),I.filter((function(e){return" "!==e})),M("consKeywords",[I[0]].concat((0,l.Z)(I)))),console.log(I),S("consKeywords.0"))}})),(0,d.jsx)("ul",{className:" grid grid-cols-4 md:grid-cols-5 lg:grid-cols-8 xl:grid-cols-5 pt-3 px-3",children:null===I||void 0===I?void 0:I.filter((function(e){return void 0!==e})).map((function(e,t){return(0,d.jsx)("li",{className:" bg-[#3D414D] text-white text-sm text-center ring-offset-1 mx-1 my-1 rounded-md h-fit hover:cursor-pointer",onClick:function(e){I=I.filter((function(t){return t!==e.currentTarget.innerHTML})),M("consKeywords",I)},children:e},t)}))})]}),(0,d.jsxs)("div",{className:" h-max bg-white mb-10 w-full border-[0.5px] border-[#BBBBBB] rounded-md overflow-x-auto",children:[(0,d.jsx)("h2",{className:" font-bold pt-1 px-2",children:"graphs and charts"}),(0,d.jsx)(u.Z,{props:G}),(0,d.jsxs)("div",{className:" grid grid-cols-2 mx-2",children:[(0,d.jsx)(m.Z,{register:T("status.0",{max:5,min:0}),required:!0,label:"\uc624\ub9ac\uc9c0\ub110\ub9ac\ud2f0",name:"status",type:"number",kind:"status"}),(0,d.jsx)(m.Z,{register:T("status.1"),required:!0,label:"\ud544\ub825",name:"status",type:"number",kind:"status"}),(0,d.jsx)(m.Z,{register:T("status.2"),required:!0,label:"\uce90\ub9ad\ud130\uc131",name:"status",type:"number",kind:"status"}),(0,d.jsx)(m.Z,{register:T("status.3"),required:!0,label:"\ud54d\uc9c4\uc131",name:"status",type:"number",kind:"status"}),(0,d.jsx)(m.Z,{register:T("status.4"),required:!0,label:"\uc2a4\ud1a0\ub9ac",name:"status",type:"number",kind:"status"}),(0,d.jsx)(m.Z,{register:T("status.5"),required:!0,label:"\uc791\ud488\uc131",name:"status",type:"number",kind:"status"})]})]})]})})]}),(0,d.jsxs)("div",{className:" mx-5 my-7 bg-white px-3 py-3 border-[0.5px] border-[#BBBBBB] rounded-md overflow-hidden",children:[(0,d.jsx)(p.Z,{register:T("synopsis"),name:"synopsis",label:"Synopsis",required:!0}),(0,d.jsx)(p.Z,{register:T("characters"),name:"characters",label:"Characters",required:!0}),(0,d.jsx)(Z,{value:r,onChange:w})]})]}),(0,d.jsx)(c.Z,{text:F?"Loading...":"\uc800\uc7a5"})]})})})}}},function(e){e.O(0,[757,369,765,913,431,774,888,179],(function(){return t=9441,e(e.s=t);var t}));var t=e.O();_N_E=t}]);